{% extends 'base.html.twig' %}

{% block title %}
  Tableau de bord
{% endblock %}
{% block widget_droite %}
   
{% endblock %}
{% block body %}


  <!-- Content Rodcdcdcdw -->
        <div class="row">
            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-primary  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                    Achat effectuer</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">
                                    {% if achats > 0 %}
                                        {{ achats }}
                                    {% else %}
                                        <p>Aucune achat </p>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-calendar fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                    Vente effectuer</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">
                                    {% if ventes > 0 %}
                                        {{ ventes }}
                                    {% else %}
                                        <p>Aucune vente </p>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-info  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Produits
                                </div>
                                <div class="row no-gutters align-items-center">
                                    <div class="col-auto">
                                        <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">
                                            {% if produits > 0 %}
                                                {{ produits }}
                                            {% else %}
                                                <p>Aucun produit </p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pending Requests Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-warning  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                    Total Achat</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">{{ totalDesAchats|number_format(2, ',', ' ') }} Ar</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-comments fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-primary  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                    Nombre client</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">
                                    6
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-user fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-danger  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">
                                    Nombre Fournisseur</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">
                                    3
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-truck fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-dark  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-dark text-secondary text-uppercase mb-1">Nombre Utilisateur
                                </div>
                                <div class="row no-gutters align-items-center">
                                    <div class="col-auto">
                                        <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">
                                            5
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pending Requests Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-secondary  h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-secondary text-uppercase mb-1">
                                    Total Vente</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">{{ totalDesVentes|number_format(2, ',', ' ') }} Ar</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-shopping-cart fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!-- Content Row -->
    <div class="row">
        <!-- Content Column -->
        <div class="col-lg-6 mb-4">
            <!-- Project Card Example -->
            <div class="card  mb-4">
            <div class="card border-left-primary  h-100 py-2">
            
            <div class="text-xs font-weight-bold text-secondary text-uppercase m-2">
                                    Statistique Achat & Vente</div>
                <div class="card-body">
        
                <canvas id="monthlyStatisticsChart" width="400" height="200"></canvas>

                <select id="yearSelector" class="form-select form-select-sm mt-2">
                    {% for year in 2021..2060 %}
                        <option value="{{ year }}">{{ year }}</option>
                    {% endfor %}
                </select>
                <script src="{{ asset('js/chart.statistics.js') }}"></script>
                
                </div>
            </div> 
            </div> 
        </div>
        <div class="col-lg-6 mb-4">
            <!-- Project Card Example -->
            <div class="card  mb-4">
            <div class="card border-left-primary  h-100 py-2">
                <div class="text-xs font-weight-bold text-secondary text-uppercase m-2">
                                        Statistique Achat & Vente</div>
                    <div class="card-body ">
                        <div class=" d-flex">
                            <label class=" font-weight-bold text-success text-uppercase mx-3"><strong>Achat : </strong></label><h5 id="totalPurchases"></h5>
                        </div>
                        
                        <div class=" d-flex">
                            <label class=" font-weight-bold text-danger text-uppercase mx-3"><strong>Vente : </strong></label><h5 id="totalSales"></h5>
                        </div>
                    </div>
                <canvas id="myChartCommande" style="width:100%;max-width:600px" class="mx-4 my-2"></canvas>

<script>
document.addEventListener('DOMContentLoaded', (event) => {
    fetch('/commandes/statistiques')
        .then(response => response.json())
        .then(data => {
            var xValues = ["en cours", "effectuer"];
            var yValues = [data.enCours, data.effectuer];
            var barColors = ["red", "green"];

            new Chart("myChartCommande", {
                type: "bar",
                data: {
                    labels: xValues,
                    datasets: [{
                        backgroundColor: barColors,
                        data: yValues
                    }]
                },
                options: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: "Commandes en cours et effectuées"
                    }
                }
            });
        });
});
</script>
                </div>

            </div>
            </div>
        </div>                
{% endblock %}
